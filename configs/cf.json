{
  "name": "NFCD",
  "percent": 20,
  "note_name": "{weight_tag}",
  "experim_name": "method_percent",
  "n_gpu": 1,
  "diff_lrs": true,
  "ramp_up": 0.1,
  "lr_scheduler": "Poly",
  "pretrained": true,
  "model": {
    "name": "encoder-decoder",
    "method": "supervised",
    "backbone": "ResNet50",
    "confidence_thr": 0.95,
    "nf_thirdStageTrain" : 0.3
  },
  "optimizer": {
    "type": "SGD",
    "args": {
      "lr": 1e-2,
      "weight_decay": 1e-4,
      "momentum": 0.9
    }
  },
  "train_supervised": {
    "data_dir": "/sd1/kzq/nfcd/DATA/WHU-CD-256",
    "batch_size": 8,
    "crop_size": 256,
    "shuffle": true,
    "base_size": 256,
    "scale": true,
    "augment": "weak",
    "flip": true,
    "rotate": true,
    "split": "train_supervised",
    "num_workers": 1
  },
  "train_unsupervised": {
    "data_dir": "/sd1/kzq/nfcd/DATA/WHU-CD-256",
    "batch_size": 8,
    "crop_size": 256,
    "shuffle": true,
    "base_size": 256,
    "scale": true,
    "augment": "strong",
    "flip": true,
    "rotate": true,
    "split": "train_unsupervised",
    "num_workers": 1
  },
  "nf_train_supervised": {
    "data_dir": "/sd1/kzq/nfcd/DATA/WHU-CD-256",
    "batch_size": 8,
    "crop_size": 256,
    "shuffle": true,
    "base_size": 256,
    "scale": true,
    "augment": "weak",
    "flip": true,
    "rotate": true,
    "split": "train_supervised",
    "num_workers": 4,
    "aug_type": "all",
    "percnt_lbl": 100
  },
  "val_loader": {
    "data_dir": "/sd1/kzq/nfcd/DATA/WHU-CD-256",
    "batch_size": 1,
    "val": true,
    "split": "val",
    "shuffle": false,
    "num_workers": 1
  },
  "trainer": {
    "epochs": 161,
    "sub_epochs": [
      80,
      10,
      80
    ],
    "process": [4],
    "save_dir": "/sd1/kzq/nfcd/outputs/{dataset}/{backbone}",
    "save_period": 5,
    "save_period_nf": 5,
    "val_per_epochs": 5,
    "val_per_epochs_nf": 5,
    "monitor": "max Mean_IoU",
    "early_stop": 10,
    "tensorboardX": true,
    "log_dir": "./outputs/nfcd",
    "log_per_iter": 20,
    "val": true,
    "best_stage_one_model": "/sd1/kzq/nfcd/outputs/WHU/supervised_all_20/stage1/best_model_thr-0.95.pth",
    "best_stage_two_model": "/sd1/kzq/nfcd/outputs/WHU/supervised_all_20/stage2/nf/best_model_nf_decoders.pth",
    "fake_label" : false,
    "fake_label_dir" : "/sd1/kzq/nfcd/outputs/WHU/supervised_all_20/stage3/fake_labels"
  },
  "nf_trainer": {
    "condition_vec": 32,
    "pool_dims": [32],
    "conv_layers": ["cov1", "conv2", "conv3"],
    "sub_epochs": 1,
    "dec_arch": "freia-flow",
    "coupling_blocks": 4,
    "clamp_alpha": 1.9,
    "lr": 0.0002,
    "lr_decay_rate": 0.1,
    "lr_warm_epochs": 0,
    "lr_warm": false,
    "lr_cosine": true,
    "pool_layers": 1,
    "N": 256,
    "meta_epochs": 10
  }

}
